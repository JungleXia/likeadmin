import{Z as T,C as Q,D as W,Q as Z,R as z,t as G,F as H}from"./element-plus.fa1aa32c.js";import{_ as J}from"./picker.875a9fd4.js";import{P as K}from"./index.8bea8b0f.js";import{r as p,f as X}from"./index.b4f64333.js";import{u as Y}from"./useDictOptions.bfd796bc.js";import{r as $}from"./role.0eca5d9e.js";import{e as ee}from"./post.978ee352.js";import{d as ue}from"./department.cc44edd3.js";import{d as le,s as A,r as ae,e as k,a0 as I,o as i,c as v,V as a,M as o,u as n,a as m,W as x,a8 as U,L as c,S as R}from"./@vue.cab01781.js";function Ce(s){return p.get({url:"/system/admin/list",params:s})}function oe(s){return p.post({url:"/system/admin/add",params:s})}function te(s){return p.get({url:"/system/admin/detail",params:s})}function se(s){return p.post({url:"/system/admin/edit",params:s})}function Ve(s){return p.post({url:"/system/admin/del",params:s})}function ve(s){return p.post({url:"/system/admin/disable",params:s})}const re={class:"edit-popup"},de=m("div",{class:"form-tips"},"\u5EFA\u8BAE\u5C3A\u5BF8\uFF1A100*100px\uFF0C\u652F\u6301jpg\uFF0Cjpeg\uFF0Cpng\u683C\u5F0F",-1),ne=m("div",{class:"form-tips"},"\u5141\u8BB8\u591A\u4EBA\u540C\u65F6\u5728\u7EBF\u767B\u5F55",-1),Ee=le({__name:"edit",emits:["success","close"],setup(s,{expose:S,emit:E}){const w=A(),F=A(),B=ae("add"),q=k(()=>B.value=="edit"?"\u7F16\u8F91\u7BA1\u7406\u5458":"\u65B0\u589E\u7BA1\u7406\u5458"),u=I({id:0,username:"",nickname:"",deptIds:[],postIds:[],roleIds:[],avatar:"",password:"",passwordConfirm:"",isDisable:0,isMultipoint:1}),f=k(()=>u.id==1),g=(d,e,t)=>{u.password&&(e||t(new Error("\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801")),e!==u.password&&t(new Error("\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4!"))),t()},_=I({username:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7",trigger:["blur"]}],nickname:[{required:!0,message:"\u8BF7\u8F93\u5165\u540D\u79F0",trigger:["blur"]}],roleIds:[{type:"array",required:!0,message:"\u8BF7\u9009\u62E9\u89D2\u8272",trigger:["blur"]}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"}],passwordConfirm:[{required:!0,message:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",trigger:"blur"},{validator:g,trigger:"blur"}]}),{optionsData:b}=Y({role:{api:$},post:{api:ee},dept:{api:ue}}),M=async()=>{var d,e;await((d=w.value)==null?void 0:d.validate()),B.value=="edit"?await se(u):await oe(u),(e=F.value)==null||e.close(),X.msgSuccess("\u64CD\u4F5C\u6210\u529F"),E("success")},L=(d="add")=>{var e;B.value=d,(e=F.value)==null||e.open()},N=async d=>{_.password=[],_.passwordConfirm=[{validator:g,trigger:"blur"}];const e=await te({id:d.id});for(const t in u)e[t]!=null&&e[t]!=null&&(u[t]=e[t])},h=()=>{E("close")};return S({open:L,setFormData:N}),(d,e)=>{const t=Q,r=W,j=J,O=T,C=Z,D=z,y=G,P=H;return i(),v("div",re,[a(K,{ref_key:"popupRef",ref:F,title:n(q),async:!0,width:"550px",onConfirm:M,onClose:h},{default:o(()=>[a(P,{ref_key:"formRef",ref:w,model:u,"label-width":"84px",rules:_},{default:o(()=>[a(r,{label:"\u8D26\u53F7",prop:"username"},{default:o(()=>[a(t,{modelValue:u.username,"onUpdate:modelValue":e[0]||(e[0]=l=>u.username=l),disabled:n(f),placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",clearable:""},null,8,["modelValue","disabled"])]),_:1}),a(r,{label:"\u5934\u50CF"},{default:o(()=>[m("div",null,[m("div",null,[a(j,{modelValue:u.avatar,"onUpdate:modelValue":e[1]||(e[1]=l=>u.avatar=l),limit:1},null,8,["modelValue"])]),de])]),_:1}),a(r,{label:"\u540D\u79F0",prop:"nickname"},{default:o(()=>[a(t,{modelValue:u.nickname,"onUpdate:modelValue":e[2]||(e[2]=l=>u.nickname=l),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",clearable:""},null,8,["modelValue"])]),_:1}),a(r,{label:"\u5F52\u5C5E\u90E8\u95E8",prop:"deptIds"},{default:o(()=>[a(O,{class:"flex-1",modelValue:u.deptIds,"onUpdate:modelValue":e[3]||(e[3]=l=>u.deptIds=l),data:n(b).dept,clearable:"","node-key":"id",multiple:"",props:{value:"id",label:"name",disabled(l){return!!l.isStop}},"check-strictly":"","default-expand-all":!0,placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8"},null,8,["modelValue","data","props"])]),_:1}),a(r,{label:"\u5C97\u4F4D",prop:"postIds"},{default:o(()=>[a(D,{class:"flex-1",clearable:"",multiple:"",modelValue:u.postIds,"onUpdate:modelValue":e[4]||(e[4]=l=>u.postIds=l),placeholder:"\u8BF7\u9009\u62E9\u5C97\u4F4D"},{default:o(()=>[(i(!0),v(x,null,U(n(b).post,(l,V)=>(i(),c(C,{key:V,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"\u89D2\u8272",prop:"roleIds"},{default:o(()=>[a(D,{modelValue:u.roleIds,"onUpdate:modelValue":e[5]||(e[5]=l=>u.roleIds=l),disabled:n(f),multiple:"",class:"flex-1",clearable:"",placeholder:"\u8BF7\u9009\u62E9\u89D2\u8272"},{default:o(()=>[n(f)?(i(),c(C,{key:0,label:"\u7CFB\u7EDF\u7BA1\u7406\u5458",value:"0"})):R("",!0),(i(!0),v(x,null,U(n(b).role,(l,V)=>(i(),c(C,{key:V,label:l.name,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),a(r,{label:"\u5BC6\u7801",prop:"password"},{default:o(()=>[a(t,{modelValue:u.password,"onUpdate:modelValue":e[6]||(e[6]=l=>u.password=l),modelModifiers:{trim:!0},"show-password":"",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),a(r,{label:"\u786E\u8BA4\u5BC6\u7801",prop:"passwordConfirm"},{default:o(()=>[a(t,{modelValue:u.passwordConfirm,"onUpdate:modelValue":e[7]||(e[7]=l=>u.passwordConfirm=l),modelModifiers:{trim:!0},"show-password":"",clearable:"",placeholder:"\u8BF7\u8F93\u5165\u786E\u8BA4\u5BC6\u7801"},null,8,["modelValue"])]),_:1}),n(f)?R("",!0):(i(),c(r,{key:0,label:"\u7BA1\u7406\u5458\u72B6\u6001"},{default:o(()=>[a(y,{modelValue:u.isDisable,"onUpdate:modelValue":e[8]||(e[8]=l=>u.isDisable=l),"active-value":0,"inactive-value":1},null,8,["modelValue"])]),_:1})),a(r,{label:"\u591A\u5904\u767B\u5F55"},{default:o(()=>[m("div",null,[a(y,{modelValue:u.isMultipoint,"onUpdate:modelValue":e[9]||(e[9]=l=>u.isMultipoint=l),"active-value":1,"inactive-value":0},null,8,["modelValue"]),ne])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])])}}});export{Ee as _,ve as a,Ve as b,Ce as c};
